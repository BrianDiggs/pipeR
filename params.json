{"name":"pipeR","tagline":"Pipeline operators for R: Making command chaining flexible and straghtforward","body":"# pipeR\r\n\r\nPipeline operators for R: Making command chaining flexible and straghtforward\r\n\r\n## Motivation\r\n\r\nIn data-driven statistical computing and data analysis, applying a chain of commands step by step is a common situation. However, it is neigher straghtforawd nor flexible to write a group of deeply nested functions in that the last functions must be written first. For example, if we need to take the following steps:\r\n\r\n1. Generate 10000 random numbers from normal distribution with mean 10 and standard deviation 1\r\n2. Take a sample of 100 without replacement from these numbers\r\n3. Take a log of the sample\r\n4. Take a difference of the log numbers\r\n5. Plot these log differences as red line segments.\r\n\r\nHere is a translation from these steps to R commands:\r\n\r\n```\r\nplot(diff(log(sample(rnorm(10000,mean=10,sd=1),size=100,replace=FALSE))),col=\"red\",type=\"l\")\r\n```\r\n\r\nThe code is neither straightforward for reading nor flexible for modification.\r\n\r\nThis package provides two types of forward-piping mechanisms: first-argument piping and free piping. The two styles of piping are implemented by `%>%` and `%>>%`, respectively.\r\n\r\n### First-argument piping\r\n\r\nThe first-argument pipe operator `%>%` insert the previous expression before all other specified arguments if any. In other words, `x %>% f(a=1)` will be translated to `f(x,a=1)`.\r\n\r\nWith the first-argument pipe operator `%>%`, you may rewrite the first example like\r\n\r\n```\r\nrnorm(10000,mean=10,sd=1) %>%\r\n  sample(size=100,replace=FALSE) %>%\r\n  log %>%\r\n  diff %>%\r\n  plot(col=\"red\",type=\"l\")\r\n```\r\n\r\n### Free piping\r\nHowever, it may not always be the case where the last result serves as the first argument of the next function call. In this situation, you may use free pipe operator `%>>%` to allow `.` to represent the last result and let you decide where it should be piped to.\r\n\r\nWith the free pipe operator `%>>%`, you can do more with `.`:\r\n\r\n```\r\nrnorm(10000,mean=10,sd=1) %>>%\r\n  sample(.,size=length(.)/500,replace=FALSE) %>>%\r\n  log %>>%\r\n  diff %>>%\r\n  plot(.,col=\"red\",type=\"l\",main=sprintf(\"length: %d\",length(.)))\r\n```\r\n\r\nNo matter which one you use, or both in one chain, your code will become much clearer and maintainable.\r\n\r\n## Installation\r\n\r\nThis package is not released to CRAN. You may install it through `devtools`.\r\n\r\n```\r\nif(!require(devtools)) install.packages(\"devtools\")\r\nrequire(devtools)\r\ninstall_github(\"pipeR\",\"renkun-ken\")\r\n```\r\n\r\n## Help overview\r\n\r\n```\r\nhelp(package = pipeR)\r\n```\r\n\r\n## Example of usage\r\n\r\n### First-argument piping with basic functions\r\n\r\n```\r\nrnorm(100) %>% plot\r\n\r\nrnorm(100) %>% plot(col=\"red\")\r\n\r\nrnorm(1000) %>% sample(size=100,replace=F) %>% hist\r\n```\r\n\r\n### Free piping with basic functions\r\n\r\n```\r\nrnorm(100) %>>% plot\r\n\r\nrnorm(100) %>>% plot(.)\r\n\r\nrnorm(100) %>>% plot(.,col=\"red\")\r\n\r\nrnorm(1000) %>>% sample(.,length(.)*0.2,F)\r\n\r\nrnorm(1000) %>>% \r\n  sample(.,length(.)*0.2,F) %>>% \r\n  plot(.,main=sprintf(\"length: %d\",length(.)))\r\n\r\nrnorm(100) %>>% {\r\n  par(mfrow=c(1,2))\r\n  hist(.,main=\"hist\")\r\n  plot(.,col=\"red\",main=sprintf(\"%d\",length(.)))\r\n} \r\n```\r\n\r\n### Mixed piping\r\n\r\n`dplyr` package provides a group of functions that make data transformation much easier. `%.%` is a built-in chain operator that pipes the previous result to the first-argument in the next function call. `%>%` is fully compatible with `dplyr` and can replace `%.%` with more consistency.\r\n\r\nThe following code demonstrates mixed piping with `dplyr` functions.\r\n\r\n```\r\nlibrary(dplyr)\r\nlibrary(hflights)\r\ndata(hflights)\r\n\r\nhflights %>%\r\n  mutate(Speed=Distance/ActualElapsedTime) %>%\r\n  group_by(UniqueCarrier) %>%\r\n  summarize(n=length(Speed),speed.mean=mean(Speed,na.rm = T),\r\n    speed.median=median(Speed,na.rm=T),\r\n    speed.sd=sd(Speed,na.rm=T)) %>%\r\n  mutate(speed.ssd=speed.mean/speed.sd) %>%\r\n  arrange(desc(speed.ssd)) %>>%\r\n  barplot(.$speed.ssd, names.arg = .$UniqueCarrier,\r\n    main=sprintf(\"Standardized mean of %d carriers\", nrow(.)))\r\n```\r\n","google":"UA-47159422-1","note":"Don't delete this file! It's used internally to help with page regeneration."}